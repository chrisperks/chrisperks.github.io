<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Chris Perks Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Chris Perks Blog Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-190277111-1","auto"),ga("set","anonymizeIp",!0),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script><title data-react-helmet="true">Deploy Sitecore 10 to Kubernetes with AWS EKS | Chris Perks</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Deploy Sitecore 10 to Kubernetes with AWS EKS | Chris Perks"><meta data-react-helmet="true" name="description" content="Feb 2021"><meta data-react-helmet="true" property="og:description" content="Feb 2021"><meta data-react-helmet="true" property="og:url" content="https://chrisperks.github.io/sitecore_deploy_to_kubernetes_eks"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://chrisperks.github.io/sitecore_deploy_to_kubernetes_eks"><link rel="stylesheet" href="/styles.3751d533.css">
<link rel="preload" href="/styles.60521670.js" as="script">
<link rel="preload" href="/runtime~main.bc5ea1d8.js" as="script">
<link rel="preload" href="/main.1c954a50.js" as="script">
<link rel="preload" href="/1.a390ae16.js" as="script">
<link rel="preload" href="/2.730d4a20.js" as="script">
<link rel="preload" href="/34.8fa07c1d.js" as="script">
<link rel="preload" href="/935f2afb.7de5e882.js" as="script">
<link rel="preload" href="/17896441.cafa2c5b.js" as="script">
<link rel="preload" href="/25e3cb9f.210ad927.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Chris Perks</strong></a></div><div class="navbar__items navbar__items--right"><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">üåû</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo.svg" alt="My Site Logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Chris Perks</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">_</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/">Home</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!"> 2021</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sitecore_10_production_aws_deploys">Production Sitecore 10 AWS EKS deploys - connecting VPCs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/load_sitecore_yaml_into_terraform">Loading Sitecore 10 Kubernetes specifications from Terraform for turbocharged CI/CD</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/sitecore_deploy_to_kubernetes_eks">Deploy Sitecore 10 to Kubernetes with AWS EKS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sitecore_sustainability_benefits">Sustainable Sitecore - reducing CO2 emissions in your Sitecore stack</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!"> 2020</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/search_engine_not_database">When Does A Search Database Become A Search Engine?</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!"> 2019</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/custom_solr_index">Create a custom Solr index in Sitecore 9</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!"> 2018</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xconnect_error">xConnect error when using Deploy Marketing Definitions tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/xconnect_local_machine">Enable xConnect on a local developer machine</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/slow_renderings">Hundreds of renderings? Your first-page-load could be sloooow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/solr_highlights">Sitecore Search Highlighting with Solr - the highlights</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/partial_view_not_found">Sitecore 9  - The partial view was not found or no view engine supports the searched locations.</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/contentsearch_quirks">Sitecore 9 - ContentSearch Solr query quirks with spaces and wildcards</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/2018_solr_error">Sitecore Solr Error - Processing Field Name. Resolving Multiple Field found on Solr Field Map. No matching template field on index field name, return type ‚ÄòString‚Äô and field type ‚Äù</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/unicorn_configs">Digging into Unicorn configs in Sitecore Habitat</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/missing_uniquekey">Sitecore Solr setup - Document is missing mandatory uniqueKey field id</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!"> 2017</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/lucene_explain">Explaining Lucene explain</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sitecore_analyzers">Visualising Sitecore Analyzers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/elasticon">Elasticon London 2017 (for a Sitecore developer)</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/patching_sitecore_commands_config">Patching the Sitecore Commands.config file</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/workaround_missing_viewdata_sitecore_mvc">A workaround for missing ViewData in Sitecore MVC</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/finding_action_name_from_mvc_processor">Finding the current Action name from an MVC pipeline processor</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/returning_json_errors_from_sitecore_mvc_controllers">Returning JSON errors from Sitecore MVC controllers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/could_not_find_process_pipeline">Error - Could not find method Process.Pipeline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sitecore_mvc_internals">Sitecore MVC Internals - IControllerActivator</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sitecore_mvc_internals_factory">Sitecore MVC internals - SitecoreControllerFactory</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!"> 2016</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/async_functionality_testing_with_xunit">C# Async functionality testing with xUnit</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Deploy Sitecore 10 to Kubernetes with AWS EKS</h1></header><div class="markdown"><p><code>Feb 2021</code></p><p>Sitecore 10 (<a href="https://doc.sitecore.com/blog/sitecore-100-released.html" target="_blank" rel="noopener noreferrer">released in August 2020</a>) introduced <a href="https://doc.sitecore.com/developers/100/developer-tools/en/containers-in-sitecore-development.html" target="_blank" rel="noopener noreferrer">Sitecore Containers</a> ‚Äì a modern way of running Sitecore both on a developer machine, and in a production environment. </p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</h5></div><div class="admonition-content"><p>In this blog post, we create a new Kubernetes cluster and deploy Sitecore 10 in XM1 formation</p></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_intro-0528de2f3c0cd19abb6f6b97f96c10f5.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introducing-docker-and-kubernetes"></a>Introducing Docker and Kubernetes<a class="hash-link" href="#introducing-docker-and-kubernetes" title="Direct link to heading">#</a></h3><p>Using Docker, local development environments can be launched with minimal fuss and complete isolation from each other ‚Äì enabling side-by-side installs of different Sitecore, Solr and MSSQL versions without any risk of cross-contamination. </p><p>In production, we can use Kubernetes to manage the deployment and runtime of our Docker containers, opening up a rich new CI/CD toolset to Sitecore developers, and giving opportunities to run less host servers, reducing operating cost and using less energy. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="but-which-kubernetes"></a>But which Kubernetes?<a class="hash-link" href="#but-which-kubernetes" title="Direct link to heading">#</a></h3><p>Sitecore provide <a href="https://github.com/Sitecore/container-deployment/releases" target="_blank" rel="noopener noreferrer">official documentation and scripts</a> for deploying Sitecore XP into a managed Kubernetes environment on Azure, the Azure Kubernetes Service (AKS). Unless you have very specific requirements (or just want the fun of running Kubernetes DIY), managed Kubernetes is a great option. You‚Äôll save money, time and headaches by letting the cloud providers do what they do best, and manage all of the infrastructure and plumbing. </p><p>Most organisations already have one (or more) chosen cloud provider. Often a cloud provider is just chosen based on the existing skillset of staff, an engineering preference or just by pure accident. Luckily, the official Sitecore Kubernetes deployment guided can be easily adapted to target non-Azure cloud providers. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="in-this-guide"></a>In this guide<a class="hash-link" href="#in-this-guide" title="Direct link to heading">#</a></h3><p>We‚Äôll be taking you through a journey to deploy a new Sitecore 10 instance into Kubernetes using <a href="https://aws.amazon.com/eks/" target="_blank" rel="noopener noreferrer">AWS‚Äô Elastic Kubernetes Service (EKS)</a>. This is AWS‚Äô equivalent of Azure Kubernetes Service (AKS) and the good news is, the effort required to deploy to EKS is not much more than AKS. A few installation steps required tweaking, and we run into a few issues along the way. But if you‚Äôre an AWS user, fear not. It‚Äôs possible!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="machine-setup"></a>Machine setup<a class="hash-link" href="#machine-setup" title="Direct link to heading">#</a></h3><p>In the modern world of DevOps and GitOps, we should always prefer scriptable operations. I‚Äôve always found the AWS web console expansive, so getting to grips with a few well designed command-line tools can make the experience a lot smoother and allows you to turn your experiments into fully functioning CI/CD pipelines at a later date.
I completed the following steps on a <code>Windows 10 Pro</code> machine with <code>Powershell 5.1.18362.1171</code>
Here is a list of the tooling we‚Äôll be installing: </p><ul><li><strong>Chocolatey</strong> ‚Äì the package manager for Windows</li><li><strong>AWS CLI</strong> ‚Äì access your AWS account from the command line</li><li><strong>kubectl</strong> ‚Äì the command line tool to manage Kubernetes</li><li><strong>eksctl</strong> ‚Äì an excellent command line to accelerate the creation and management of Kubernetes clusters </li><li><strong>helm</strong> ‚Äì the package manager for Kubernetes</li></ul><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="1-open-a-powershell-session-as-administrator-and-install-chocolatey"></a>1. Open a Powershell session as Administrator, and install Chocolatey<a class="hash-link" href="#1-open-a-powershell-session-as-administrator-and-install-chocolatey" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; iex ((New-Object System.Net.WebClient).DownloadString(&#x27;https://chocolatey.org/install.ps1&#x27;))</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="2-install-the-aws-cli"></a>2. Install the AWS CLI<a class="hash-link" href="#2-install-the-aws-cli" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">choco install awscli</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="3-add-your-aws-credentials-to-the-current-powershell-session"></a>3. Add your AWS credentials to the current Powershell session<a class="hash-link" href="#3-add-your-aws-credentials-to-the-current-powershell-session" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$Env:AWS_ACCESS_KEY_ID=&quot;*********************&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$Env:AWS_SECRET_ACCESS_KEY=&quot;*********************&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">$Env:AWS_DEFAULT_REGION=&quot;eu-north-1&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>These will be your own credentials, you can get them from the AWS Console. Note that you should set your preferred region ‚Äì here I‚Äôm using Stockholm. </p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="4-test-to-make-sure-the-aws-cli-can-connect-to-your-account"></a>4. Test to make sure the AWS CLI can connect to your account<a class="hash-link" href="#4-test-to-make-sure-the-aws-cli-can-connect-to-your-account" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">aws s3 ls </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_03-30f8213ae78835a8a24772e4ff32346a.jpeg"></p><p>You might not have any buckets here ‚Äì that‚Äôs okay. But if you get an authentication error, your credentials are incorrect. Fix that before moving on. </p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="5-install-the-eksctl-tool"></a>5. Install the eksctl tool<a class="hash-link" href="#5-install-the-eksctl-tool" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">choco install eksctl </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_05-758d25b34a10f008e24fc7ba9955996e.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="6-install-the-kubectl-tool"></a>6. Install the kubectl tool<a class="hash-link" href="#6-install-the-kubectl-tool" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">choco install kubernetes-cli</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="7-check-that-eksctl-is-ready-to-go-look-for-the-region-youre-using-to-make-sure-that-is-correct"></a>7. Check that eksctl is ready to go! Look for the region you‚Äôre using, to make sure that is correct.<a class="hash-link" href="#7-check-that-eksctl-is-ready-to-go-look-for-the-region-youre-using-to-make-sure-that-is-correct" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl get cluster</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_08-ed0b798c8038dde15944ced22d8f0368.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="8-install-helm"></a>8. Install Helm<a class="hash-link" href="#8-install-helm" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">choco install kubernetes-helm</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="create-and-test-the-cluster"></a>Create and test the cluster<a class="hash-link" href="#create-and-test-the-cluster" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="9-create-the-cluster"></a>9. Create the cluster<a class="hash-link" href="#9-create-the-cluster" title="Direct link to heading">#</a></h5><p>Now we can begin the action! Creating a Kubernetes cluster sounds complicated at first, but eksctl does a great job of managing the underlying components and gives you a very simple API to work with: </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create cluster --name sitecore-10-cluster </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>This took around 15 minutes for me. Grab a tea!</p></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_10-8e5c7650a1336bc47f9ca8be5be90154.jpeg"></p><p>Notice that we‚Äôre not providing much configuration here. That‚Äôs perfectly fine, as eksctl will give us a new cluster with a Linux node by default. This is required on EKS. Even though our eventual Sitecore containers will run on a Windows host node, the required control plane components for EKS need to run on a Linux host. </p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="10-test-that-the-cluster-is-up-and-running"></a>10. Test that the cluster is up and running<a class="hash-link" href="#10-test-that-the-cluster-is-up-and-running" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get svc</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_12-f8291d8780b1467848732d178c02b77b.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="11-we-now-need-to-modify-the-cluster-in-preparation-for-launching-a-windows-node-this-requires-an-extra-networking-component-that-our-default-cluster-creation-didnt-provide-again-eksctl-handles-most-of-the-work"></a>11.	We now need to modify the cluster in preparation for launching a Windows node. This requires an extra networking component that our default cluster creation didn‚Äôt provide. Again, eksctl handles most of the work:<a class="hash-link" href="#11-we-now-need-to-modify-the-cluster-in-preparation-for-launching-a-windows-node-this-requires-an-extra-networking-component-that-our-default-cluster-creation-didnt-provide-again-eksctl-handles-most-of-the-work" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl utils install-vpc-controllers ‚Äìcluster sitecore-10-cluster ‚Äìapprove</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_13-e6134368c58262f62207de57da65d1d4.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="12-lets-take-a-quick-break-to-peek-inside-the-aws-console-and-see-how-things-look-there-if-all-is-happy-youll-see-the-following"></a>12. Let‚Äôs take a quick break to peek inside the AWS Console and see how things look there. If all is happy, you‚Äôll see the following:<a class="hash-link" href="#12-lets-take-a-quick-break-to-peek-inside-the-aws-console-and-see-how-things-look-there-if-all-is-happy-youll-see-the-following" title="Direct link to heading">#</a></h5><p><img alt="img" src="/assets/images/2021_sitecore_eks_14-ac9e72235b1ef831129c2b04518ab2f9.jpeg"></p><p>We have three Kubernetes control workloads (<code>coredns</code>, <code>aws-node</code> and <code>kube-proxy</code>) along with the two VPC workloads we just created to support our Windows node: <code>vpc-resource-controller</code> and <code>vpc-admission-webhook</code>. </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="adding-the-windows-node"></a>Adding the Windows node<a class="hash-link" href="#adding-the-windows-node" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="13-as-sitecore-runs-inside-windows-docker-containers-we-need-a-windows-node-to-host-those-containers"></a>13.	As Sitecore runs inside Windows Docker containers, we need a Windows node to host those containers.<a class="hash-link" href="#13-as-sitecore-runs-inside-windows-docker-containers-we-need-a-windows-node-to-host-those-containers" title="Direct link to heading">#</a></h5><p>This is one of the big differences between containers and classic virtual machines ‚Äì containers share most of the OS stack with the underlying host ‚Äì so (for now), Windows containers require a Windows host. </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl create nodegroup --cluster sitecore-10-cluster --name ng-windows --node-type t2.large --nodes 1 --nodes-min 1 --nodes-max 1 --node-ami-family WindowsServer2019FullContainer --region eu-north-1</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>At this point, I waited and waited, but the node never reached the <code>Ready</code> state. I had no idea what the issue was ‚Äì but got the opportunity to learn some Kubernetes troubleshooting tools! See the Troubleshooting section at the end of this article. </p><p>After some research, I discovered that the <code>t2.large</code> node type is not supported for the type of Windows deployment I was attempting. I changed this to <code>t3.large</code> and after more waiting, the node finally came online. </p><p><img alt="img" src="/assets/images/2021_sitecore_eks_17-e09021a23df9aa0e871a272bb8e9ea6c.jpeg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="configure-the-deployment"></a>Configure the deployment<a class="hash-link" href="#configure-the-deployment" title="Direct link to heading">#</a></h3><p>Our cluster is now up and running, with a Windows node ready for us to deploy Sitecore to. </p><p><img alt="img" src="/assets/images/2021_sitecore_eks_19-547fa1d51d9a42d6edafb0e11ae96079.jpeg"></p><p><img alt="img" src="/assets/images/2021_sitecore_eks_20-c11aeeed41ef6717eedabff8bd1cde70.jpeg"></p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p><strong>A quick note on Topologies</strong></p><p>You may wonder why we only have a single Windows node. Is that enough? Here, you should make a choice of which Sitecore topology you wish to deploy. Sitecore themselves provide Kubernetes specifications for XM1 and XP1 topologies. I chose XM1 as this was my first attempt at a Sitecore Kubernetes deployment and I figured ‚Äì less to go wrong!</p><p>From here on out, assume that the steps relate to an XM1 deployment, but that the same approach can be followed for an XP1 deployment, with a little extra care. </p></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="14--now-lets-grab-the-necessary-sitecore-installation-files"></a>14.	 Now, lets grab the necessary Sitecore installation files.<a class="hash-link" href="#14--now-lets-grab-the-necessary-sitecore-installation-files" title="Direct link to heading">#</a></h5><p>Go to the <a href="https://dev.sitecore.net/Downloads/Sitecore_Experience_Platform/100/Sitecore_Experience_Platform_100_Update1.aspx" target="_blank" rel="noopener noreferrer">Sitecore 10 Release Page</a> and follow the link to the correct <code>SXP Sitecore Container Deployment</code> zip file. The one I used was <a href="https://github.com/Sitecore/container-deployment/releases/tag/sxp%2F10.0.1.004842.266" target="_blank" rel="noopener noreferrer">10.0.1.004842.266</a> ‚Äì but as new updates come out, you may want to use the latest. </p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="15--expand-the-zip-and-copy-the-contents-of-the-k8sltsc2019xm1-folder-to-a-working-area-somewhere-in-easy-reach-of-your-powershell-session"></a>15.	 Expand the zip and copy the contents of the k8s/ltsc2019/xm1 folder to a working area, somewhere in easy reach of your Powershell session.<a class="hash-link" href="#15--expand-the-zip-and-copy-the-contents-of-the-k8sltsc2019xm1-folder-to-a-working-area-somewhere-in-easy-reach-of-your-powershell-session" title="Direct link to heading">#</a></h5><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="16--populate-the-secrets"></a>16.	 Populate the secrets.<a class="hash-link" href="#16--populate-the-secrets" title="Direct link to heading">#</a></h5><p>Within the secrets folder, make sure that all <code>.txt</code> files are populated and that you‚Äôve placed certificates into the <code>tls</code> folders. The easiest way to get all of the values you need here, in the correct formats, is to use the Getting Started Powershell configuration script from here: <a href="https://github.com/Sitecore/docker-examples/blob/develop/getting-started/init.ps1" target="_blank" rel="noopener noreferrer">https://github.com/Sitecore/docker-examples/blob/develop/getting-started/init.ps1</a> </p><p>When everything is ready, you will have a values in all <code>.txt</code> files and a <code>tls.crt</code> / <code>tls.key</code> file in each of the subfolders of <code>/tls/</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="deploy"></a>Deploy!<a class="hash-link" href="#deploy" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="17-the-first-deployment-task-is-for-the-ingress-controller-for-our-cluster-begin-by-adding-the-help-chart-repository"></a>17.	The first deployment task is for the ingress controller for our cluster. Begin by adding the help chart repository:<a class="hash-link" href="#17-the-first-deployment-task-is-for-the-ingress-controller-for-our-cluster-begin-by-adding-the-help-chart-repository" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"># helm repo add stable https://kubernetes-charts.storage.googleapis.com/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Is now deprecated, so use the following repo instead: </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm repo add stable https://charts.helm.sh/stable</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_21-105433043d2153b7a0dd331f3392938c.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="18--now-we-can-use-helm-to-install-our-ingress-controller-which-is-based-on-nginx"></a>18.	 Now we can use helm to install our ingress controller, which is based on Nginx:<a class="hash-link" href="#18--now-we-can-use-helm-to-install-our-ingress-controller-which-is-based-on-nginx" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">helm install nginx-ingress stable/nginx-ingress --set controller.replicaCount=1 --set controller.nodeSelector.&quot;beta\.kubernetes\.io/os&quot;=linux --set defaultBackend.nodeSelector.&quot;beta\.kubernetes\.io/os&quot;=linux --set-string controller.config.proxy-body-size=10m --set controller.service.externalTrafficPolicy=Local</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="19-wait-until-the-new-pods-are-running"></a>19.	Wait until the new pods are running:<a class="hash-link" href="#19-wait-until-the-new-pods-are-running" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_23-110791e7b43a93881130f10e6d2047a4.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="20-deploy-the-secrets-we-just-configured"></a>20.	Deploy the secrets we just configured:<a class="hash-link" href="#20-deploy-the-secrets-we-just-configured" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -k ./secrets/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_26-de5fac945ac0b8a50761b95bbf266f54.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="21--for-our-initial-deployment-well-run-solr-and-mssql-inside-containers--this-speeds-up-our-workflow-to-get-a-sitecore-instance-running-in-production-youll-want-to-swap-these-out-for-managed-services"></a>21.	 For our initial deployment, we‚Äôll run Solr and MSSQL inside containers ‚Äì this speeds up our workflow to get a Sitecore instance running. In production, you‚Äôll want to swap these out for managed services.<a class="hash-link" href="#21--for-our-initial-deployment-well-run-solr-and-mssql-inside-containers--this-speeds-up-our-workflow-to-get-a-sitecore-instance-running-in-production-youll-want-to-swap-these-out-for-managed-services" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ./external/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="22-once-our-solr-and-mssql-containers-are-in-the-running-state-we-can-initialise-them-with-data"></a>22.	Once our Solr and MSSQL containers are in the ‚ÄúRunning‚Äù state, we can initialise them with data:<a class="hash-link" href="#22-once-our-solr-and-mssql-containers-are-in-the-running-state-we-can-initialise-them-with-data" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ./init/</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="23-at-last--its-the-time-to-deploy-our-sitecore-cm-cd-and-id-containers"></a>23 At last ‚Äì it‚Äôs the time to deploy our Sitecore CM, CD and ID containers!<a class="hash-link" href="#23-at-last--its-the-time-to-deploy-our-sitecore-cm-cd-and-id-containers" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ./</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_34-750139358866c3e974964695dab10100.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="24-now-that-our-sitecore-containers-are-running-lets-update-our-ingress-controller-to-enable-traffic-to-flow-through-our-cluster"></a>24. Now that our Sitecore containers are running, let‚Äôs update our Ingress controller to enable traffic to flow through our cluster:<a class="hash-link" href="#24-now-that-our-sitecore-containers-are-running-lets-update-our-ingress-controller-to-enable-traffic-to-flow-through-our-cluster" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl apply -f ./ingress-nginx/ingress.yaml</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="test-the-deployment"></a>Test the deployment<a class="hash-link" href="#test-the-deployment" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="25-at-this-point-your-deployments-should-be-working-away-run-the-following-commands-to-check-on-their-status"></a>25. At this point, your deployments should be working away. Run the following commands to check on their status:<a class="hash-link" href="#25-at-this-point-your-deployments-should-be-working-away-run-the-following-commands-to-check-on-their-status" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get service -l app=nginx-ingress</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_37-b24b1ee455ac2f0b18803d416c88d7c0.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="26-once-your-deployment-is-complete-grab-the-external-ip-shown-above-we-can-use-nslookup-to-find-the-ip-address-to-add-to-our-hosts-file"></a>26. Once your deployment is complete, grab the EXTERNAL-IP shown above. We can use NSLOOKUP to find the IP address to add to our hosts file.<a class="hash-link" href="#26-once-your-deployment-is-complete-grab-the-external-ip-shown-above-we-can-use-nslookup-to-find-the-ip-address-to-add-to-our-hosts-file" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">nslookup ABC-115789212.eu-north-1.elb.amazonaws.com</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_40-e1e49248645c98b37f9012a1c2c17037.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="27-add-this-to-your-hosts-file"></a>27. Add this to your hosts file<a class="hash-link" href="#27-add-this-to-your-hosts-file" title="Direct link to heading">#</a></h5><p><img alt="img" src="/assets/images/2021_sitecore_eks_41-0bfe4451e90437c13f313cd13f735acf.jpeg"></p><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="28-open-up-a-browser-and-navigate-to-cmglobalhostsitecore--if-everything-went-to-plan-youll-see-the-sitecore-login-page"></a>28. Open up a browser and navigate to cm.globalhost/sitecore ‚Äì if everything went to plan, you‚Äôll see the Sitecore login page!<a class="hash-link" href="#28-open-up-a-browser-and-navigate-to-cmglobalhostsitecore--if-everything-went-to-plan-youll-see-the-sitecore-login-page" title="Direct link to heading">#</a></h5><p><img alt="img" src="/assets/images/2021_sitecore_eks_43-04ffc0508fe1d08e5d16a5f03a2c0664.jpg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="destroy-all-the-things"></a>Destroy all the things<a class="hash-link" href="#destroy-all-the-things" title="Direct link to heading">#</a></h3><h5><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="29-once-youre-done-and-happy-with-your-experiment-you-can-destroy-the-cluster"></a>29. Once you‚Äôre done and happy with your experiment, you can destroy the cluster:<a class="hash-link" href="#29-once-youre-done-and-happy-with-your-experiment-you-can-destroy-the-cluster" title="Direct link to heading">#</a></h5><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">eksctl delete cluster ‚Äìname=sitecore-10-cluster</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><img alt="img" src="/assets/images/2021_sitecore_eks_42-2e33145de113ab6739364dd4d984a29e.jpeg"></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="troubleshooting"></a>Troubleshooting<a class="hash-link" href="#troubleshooting" title="Direct link to heading">#</a></h3><p>While deploying to EKS, I hit a few problems - mostly with invalid configurations, which I&#x27;ve since corrected in the steps above. However, it&#x27;s handy to know how to peek inside your cluster and get more information about troubled pods and nodes. </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get pods</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>get pods will show you a list of pods - you can then use the name of an individual pod to get detailed information on that pod: </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl describe pod my-pod</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If there&#x27;s a problem with your cluster or a particular pod, you may be able to surface the error by looking in the Kubernetes event log: </p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-powershell codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">kubectl get events</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="conclusion"></a>Conclusion<a class="hash-link" href="#conclusion" title="Direct link to heading">#</a></h3><p>In this post, we&#x27;ve gone from an empty AWS EKS service to having a fully working Kubernetes cluster, complete with Windows worker node and running Sitecore 10. Excellent work! The team at Sitecore have put in a huge amount of work to make this deployment method available to us, and I&#x27;ve been really impressed with how things work. </p><p>There are plenty of next steps - replacing the data services (Solr, MSSQL) with managed AWS services - achieving a more production-like environment with multiple nodes - scaling up and down. </p><p>I hope to blog more about these topics in the coming months. </p><p>Have fun!</p></div></article><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/load_sitecore_yaml_into_terraform"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Loading Sitecore 10 Kubernetes specifications from Terraform for turbocharged CI/CD</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/sitecore_sustainability_benefits"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Sustainable Sitecore - reducing CO2 emissions in your Sitecore stack ¬ª</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introducing-docker-and-kubernetes" class="table-of-contents__link">Introducing Docker and Kubernetes</a></li><li><a href="#but-which-kubernetes" class="table-of-contents__link">But which Kubernetes?</a></li><li><a href="#in-this-guide" class="table-of-contents__link">In this guide</a></li><li><a href="#machine-setup" class="table-of-contents__link">Machine setup</a></li><li><a href="#create-and-test-the-cluster" class="table-of-contents__link">Create and test the cluster</a></li><li><a href="#adding-the-windows-node" class="table-of-contents__link">Adding the Windows node</a></li><li><a href="#configure-the-deployment" class="table-of-contents__link">Configure the deployment</a></li><li><a href="#deploy" class="table-of-contents__link">Deploy!</a></li><li><a href="#test-the-deployment" class="table-of-contents__link">Test the deployment</a></li><li><a href="#destroy-all-the-things" class="table-of-contents__link">Destroy all the things</a></li><li><a href="#troubleshooting" class="table-of-contents__link">Troubleshooting</a></li><li><a href="#conclusion" class="table-of-contents__link">Conclusion</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">My Links</h4><ul class="footer__items"><li class="footer__item"><a href="https://www.linkedin.com/in/christofr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn</a></li><li class="footer__item"><a href="https://github.com/christofur" target="_blank" rel="noopener noreferrer" class="footer__link-item">Github</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">¬© 2021 Chris Perks</div></div></div></footer></div>
<script src="/styles.60521670.js"></script>
<script src="/runtime~main.bc5ea1d8.js"></script>
<script src="/main.1c954a50.js"></script>
<script src="/1.a390ae16.js"></script>
<script src="/2.730d4a20.js"></script>
<script src="/34.8fa07c1d.js"></script>
<script src="/935f2afb.7de5e882.js"></script>
<script src="/17896441.cafa2c5b.js"></script>
<script src="/25e3cb9f.210ad927.js"></script>
</body>
</html>