(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{101:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return m}));var r=n(0),o=n.n(r);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=o.a.createContext({}),d=function(e){var t=o.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):c(c({},t),e)),n},u=function(e){var t=d(e.components);return o.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},b=o.a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,a=e.parentName,s=l(e,["components","mdxType","originalType","parentName"]),u=d(n),b=r,m=u["".concat(a,".").concat(b)]||u[b]||p[b]||i;return n?o.a.createElement(m,c(c({ref:t},s),{},{components:n})):o.a.createElement(m,c({ref:t},s))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,a=new Array(i);a[0]=b;var c={};for(var l in t)hasOwnProperty.call(t,l)&&(c[l]=t[l]);c.originalType=e,c.mdxType="string"==typeof e?e:r,a[1]=c;for(var s=2;s<i;s++)a[s]=n[s];return o.a.createElement.apply(null,a)}return o.a.createElement.apply(null,n)}b.displayName="MDXCreateElement"},65:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return c})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return d}));var r=n(3),o=n(7),i=(n(0),n(101)),a={id:"custom_solr_index",title:"Create a custom Solr index in Sitecore 9"},c={unversionedId:"custom_solr_index",id:"custom_solr_index",isDocsHomePage:!1,title:"Create a custom Solr index in Sitecore 9",description:"Hello there.",source:"@site/docs/2019_custom_solr_index.md",slug:"/custom_solr_index",permalink:"/custom_solr_index",version:"current",sidebar:"someSidebar",previous:{title:"When Does A Search Database Become A Search Engine?",permalink:"/search_engine_not_database"},next:{title:"xConnect error when using Deploy Marketing Definitions tool",permalink:"/xconnect_error"}},l=[],s={toc:l};function d(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(i.b)("h4",{id:"hello-there"},"Hello there."),Object(i.b)("p",null,"Hi! So you want to create a new Solr index?"),Object(i.b)("h4",{id:"yes-i-think-so"},"Yes, I think so?"),Object(i.b)("p",null,"It\u2019s a great idea. You\u2019ll be familiar with the big three, ",Object(i.b)("inlineCode",{parentName:"p"},"sitecore_core_index, sitecore_master_index and sitecore_web_index"),", but you don\u2019t have to stop there! You can create individual indexes for certain content types on your site, such as Products. Smaller, more individualised indexes are easier to maintain, troubleshoot, faster to rebuild and can be faster to query."),Object(i.b)("h4",{id:"are-they-hard-to-set-up"},"Are they hard to set up?"),Object(i.b)("p",null,"Not as hard as you\u2019d expect! Let\u2019s create one now."),Object(i.b)("p",null,"OK. My Solr is set up and I can access the web UI on https://solr:8983/solr/#/ \u2013 what now?"),Object(i.b)("h4",{id:"lets-create-the-physical-solr-core"},"Let\u2019s create the physical Solr core."),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Find your Solr index folder for the sitecore_master_index. Mine was at ",Object(i.b)("inlineCode",{parentName:"li"},"C:\\solr\\solr-6.6.2\\server\\solr\\sitecore_master_index")),Object(i.b)("li",{parentName:"ol"},"Copy this whole folder (into the same parent folder) and call it ",Object(i.b)("inlineCode",{parentName:"li"},"sitecore_master_products_index")),Object(i.b)("li",{parentName:"ol"},"Inside the ",Object(i.b)("inlineCode",{parentName:"li"},"sitecore_master_products_index")," folder, open up the core.properties file and change the name property to read ",Object(i.b)("inlineCode",{parentName:"li"},"sitecore_master_products_index")),Object(i.b)("li",{parentName:"ol"},"Restart Solr (I use the solr stop and solr start commands \u2013 see below)"),Object(i.b)("li",{parentName:"ol"},"Now, go to ",Object(i.b)("inlineCode",{parentName:"li"},"https://solr:8983/solr/#/")," and check out your cores \u2013 you will have a new one!")),Object(i.b)("p",null,"Awesome, it\u2019s there. So I get that we copied the sitecore_master_index and renamed it to ",Object(i.b)("inlineCode",{parentName:"p"},"sitecore_master_products_index")," \u2013 and in Solr I can see that it contains thousands of documents already, copied from ",Object(i.b)("inlineCode",{parentName:"p"},"sitecore_master_index"),". How do I clean things up?"),Object(i.b)("p",null,"Well, good question. We want to delete all of the existing items in this index and start afresh. You can do this via a web browser \u2013 just call this URL:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-csharp"}),"https://solr:8983/solr/sitecore_master_products_index/update?commit=true&stream.body=<delete><query>*:*</query></delete>\n")),Object(i.b)("p",null,"Radical. Everything is deleted. Soo. I want to use this index to only contain certain types of content from Sitecore. How do I configure it properly?"),Object(i.b)("p",null,"We need to just add a single configuration file to Sitecore. It\u2019s below. It looks mostly like the configuration file for ",Object(i.b)("inlineCode",{parentName:"p"},"sitecore_master_index"),", but we change two important things, (a) which template types we want to include in our index and (b) which field types we want to include in our index. In your real solution, this will take a bit of time to set up, but being selective is the whole point of creating a custom index, and you\u2019ll want to keep it as trim as possible."),Object(i.b)("p",null,"Here\u2019s the whole config file, which I\u2019ve called ",Object(i.b)("inlineCode",{parentName:"p"},"Sitecore.ContentSearch.Solr.Index.Master.Products.config"),":"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-xml"}),'<?xml version="1.0" encoding="utf-8" ?>\n<configuration xmlns:patch="http://www.sitecore.net/xmlconfig/" xmlns:role="http://www.sitecore.net/xmlconfig/role/" xmlns:search="http://www.sitecore.net/xmlconfig/search/">\n  <sitecore role:require="Standalone or ContentManagement" search:require="solr">\n    <contentSearch>\n      <configuration type="Sitecore.ContentSearch.ContentSearchConfiguration, Sitecore.ContentSearch">\n        <indexes hint="list:AddIndex">\n          <index id="sitecore_master_products_index" type="Sitecore.ContentSearch.SolrProvider.SolrSearchIndex, Sitecore.ContentSearch.SolrProvider">\n            <param desc="name">$(id)</param>\n            <param desc="core">$(id)</param>\n            <param desc="propertyStore" ref="contentSearch/indexConfigurations/databasePropertyStore" param1="$(id)" />\n              <configuration ref="contentSearch/indexConfigurations/defaultSolrIndexConfiguration">\n                  <documentOptions type="Sitecore.ContentSearch.SolrProvider.SolrDocumentBuilderOptions, Sitecore.ContentSearch.SolrProvider">\n                      <indexAllFields>false</indexAllFields>\n\n                      \x3c!-- Included fields --\x3e\n                      <include hint="list:AddIncludedField">\n                          <ProductName>{E676F36E-B0E0-4BE5-998A-329A8F9055FD}</ProductName>\n                          <LongDescription>{8A978A2E-0E7A-4415-9163-2F4ECF85A3AB}</LongDescription>\n                      </include>\n\n                      \x3c!-- Included templates --\x3e\n                      <include hint="list:AddIncludedTemplate">\n                          <Product>{665DC431-673A-4D63-B9A6-00EB148E693C}</Product>\n                      </include>\n\n                  </documentOptions>\n              </configuration>\n            <strategies hint="list:AddStrategy">\n              <strategy ref="contentSearch/indexConfigurations/indexUpdateStrategies/syncMaster" />\n            </strategies>\n            <locations hint="list:AddCrawler">\n              <crawler type="Sitecore.ContentSearch.SitecoreItemCrawler, Sitecore.ContentSearch">\n                <Database>master</Database>\n                <Root>/sitecore</Root>\n              </crawler>\n            </locations>\n            <enableItemLanguageFallback>false</enableItemLanguageFallback>\n            <enableFieldLanguageFallback>false</enableFieldLanguageFallback>\n          </index>\n        </indexes>\n      </configuration>\n    </contentSearch>\n  </sitecore>\n</configuration>\n')),Object(i.b)("p",null,"The two bits you\u2019ll need to replace here are the bits commented as Included Fields and Included Templates:"),Object(i.b)("pre",null,Object(i.b)("code",Object(r.a)({parentName:"pre"},{className:"language-xml"}),'\x3c!-- Included fields --\x3e\n<include hint="list:AddIncludedField">\n  <ProductName>{E676F36E-B0E0-4BE5-998A-329A8F9055FD}</ProductName>\n  <LongDescription>{8A978A2E-0E7A-4415-9163-2F4ECF85A3AB}</LongDescription>\n</include>\n\n\x3c!-- Included templates --\x3e\n<include hint="list:AddIncludedTemplate">\n  <Product>{665DC431-673A-4D63-B9A6-00EB148E693C}</Product>\n</include>\n')),Object(i.b)("p",null,"OK, done. I\u2019ve added my list of templates, and fields here. So, can I reindex now and see my new content?"),Object(i.b)("p",null,"Absolutely. Go into ",Object(i.b)("inlineCode",{parentName:"p"},"Sitecore > Control Panel > Indexing Manager"),", find your index and rebuild it."),Object(i.b)("p",null,"When you\u2019re done, go back to the Solr UI and see your documents! If things didn\u2019t go quite to plan, check in your site ",Object(i.b)("inlineCode",{parentName:"p"},"Crawling.log"),", which will contain any indexing errors."),Object(i.b)("h4",{id:"production-ready"},"Production ready?"),Object(i.b)("p",null,"Well, not quite. You might want to create a ",Object(i.b)("inlineCode",{parentName:"p"},"sitecore_web_products_index")," and use the ",Object(i.b)("inlineCode",{parentName:"p"},"Sitecore.ContentSearch.Solr.Index.Web.config")," configuration file as an example of how to register it in Sitecore. Using Sitecore\u2019s conventions for master and web keep the surprises to a minimum."),Object(i.b)("p",null,"Search on, pals!"))}d.isMDXComponent=!0}}]);